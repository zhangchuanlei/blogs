
insert into  midata.web_action_local (    uuid,    visit_id,    app_id,    app_version_id,    agent_id,    os_id,    device_id,    country_id,    region_id,    city_id,    carrier_id,    action_type,    action_name,    view_name,    is_slow,    customer_name,    device_uuid,    start_time,    end_time,    duration,    cpu,    mem,    battery,    visit_start_time,    http_total_count,    http_error_count,    http_slow_count,    http_bytes_sent,    http_bytes_received,    view_loading_time,    view_loading_count,    view_loading_slow_count,    timestamp,    ch_start_date,    browser_id,    ip) SELECT      uuid,      visit_id,      app_id,      app_version_id,      agent_id,      os_id,      device_id,      country_id,      region_id,      city_id,      carrier_id,      action_type,      action_name,      view_name,      is_slow,      customer_name,      device_uuid,      start_time,      end_time,      duration,      cpu,      mem,      battery,      visit_start_time,      http_total_count,      http_error_count,      http_slow_count,      http_bytes_sent,      http_bytes_received,      view_loading_time,      view_loading_count,      view_loading_slow_count,      timestamp,      ch_start_date,      browser_id,      ip FROM midata.`.inner.web_action_local_bak_1108`
 where ch_start_date='2020-1-4';
insert into  midata.web_action_local (    uuid,    visit_id,    app_id,    app_version_id,    agent_id,    os_id,    device_id,    country_id,    region_id,    city_id,    carrier_id,    action_type,    action_name,    view_name,    is_slow,    customer_name,    device_uuid,    start_time,    end_time,    duration,    cpu,    mem,    battery,    visit_start_time,    http_total_count,    http_error_count,    http_slow_count,    http_bytes_sent,    http_bytes_received,    view_loading_time,    view_loading_count,    view_loading_slow_count,    timestamp,    ch_start_date,    browser_id,    ip) SELECT      uuid,      visit_id,      app_id,      app_version_id,      agent_id,      os_id,      device_id,      country_id,      region_id,      city_id,      carrier_id,      action_type,      action_name,      view_name,      is_slow,      customer_name,      device_uuid,      start_time,      end_time,      duration,      cpu,      mem,      battery,      visit_start_time,      http_total_count,      http_error_count,      http_slow_count,      http_bytes_sent,      http_bytes_received,      view_loading_time,      view_loading_count,      view_loading_slow_count,      timestamp,      ch_start_date,      browser_id,      ip FROM midata.`.inner.web_action_local_bak_1108`
 where ch_start_date='2020-1-3';
insert into  midata.web_action_local (    uuid,    visit_id,    app_id,    app_version_id,    agent_id,    os_id,    device_id,    country_id,    region_id,    city_id,    carrier_id,    action_type,    action_name,    view_name,    is_slow,    customer_name,    device_uuid,    start_time,    end_time,    duration,    cpu,    mem,    battery,    visit_start_time,    http_total_count,    http_error_count,    http_slow_count,    http_bytes_sent,    http_bytes_received,    view_loading_time,    view_loading_count,    view_loading_slow_count,    timestamp,    ch_start_date,    browser_id,    ip) SELECT      uuid,      visit_id,      app_id,      app_version_id,      agent_id,      os_id,      device_id,      country_id,      region_id,      city_id,      carrier_id,      action_type,      action_name,      view_name,      is_slow,      customer_name,      device_uuid,      start_time,      end_time,      duration,      cpu,      mem,      battery,      visit_start_time,      http_total_count,      http_error_count,      http_slow_count,      http_bytes_sent,      http_bytes_received,      view_loading_time,      view_loading_count,      view_loading_slow_count,      timestamp,      ch_start_date,      browser_id,      ip FROM midata.`.inner.web_action_local_bak_1108`
 where ch_start_date='2020-1-2';
insert into  midata.web_action_local (    uuid,    visit_id,    app_id,    app_version_id,    agent_id,    os_id,    device_id,    country_id,    region_id,    city_id,    carrier_id,    action_type,    action_name,    view_name,    is_slow,    customer_name,    device_uuid,    start_time,    end_time,    duration,    cpu,    mem,    battery,    visit_start_time,    http_total_count,    http_error_count,    http_slow_count,    http_bytes_sent,    http_bytes_received,    view_loading_time,    view_loading_count,    view_loading_slow_count,    timestamp,    ch_start_date,    browser_id,    ip) SELECT      uuid,      visit_id,      app_id,      app_version_id,      agent_id,      os_id,      device_id,      country_id,      region_id,      city_id,      carrier_id,      action_type,      action_name,      view_name,      is_slow,      customer_name,      device_uuid,      start_time,      end_time,      duration,      cpu,      mem,      battery,      visit_start_time,      http_total_count,      http_error_count,      http_slow_count,      http_bytes_sent,      http_bytes_received,      view_loading_time,      view_loading_count,      view_loading_slow_count,      timestamp,      ch_start_date,      browser_id,      ip FROM midata.`.inner.web_action_local_bak_1108`
 where ch_start_date='2020-1-1';
insert into  midata.web_action_local (    uuid,    visit_id,    app_id,    app_version_id,    agent_id,    os_id,    device_id,    country_id,    region_id,    city_id,    carrier_id,    action_type,    action_name,    view_name,    is_slow,    customer_name,    device_uuid,    start_time,    end_time,    duration,    cpu,    mem,    battery,    visit_start_time,    http_total_count,    http_error_count,    http_slow_count,    http_bytes_sent,    http_bytes_received,    view_loading_time,    view_loading_count,    view_loading_slow_count,    timestamp,    ch_start_date,    browser_id,    ip) SELECT      uuid,      visit_id,      app_id,      app_version_id,      agent_id,      os_id,      device_id,      country_id,      region_id,      city_id,      carrier_id,      action_type,      action_name,      view_name,      is_slow,      customer_name,      device_uuid,      start_time,      end_time,      duration,      cpu,      mem,      battery,      visit_start_time,      http_total_count,      http_error_count,      http_slow_count,      http_bytes_sent,      http_bytes_received,      view_loading_time,      view_loading_count,      view_loading_slow_count,      timestamp,      ch_start_date,      browser_id,      ip FROM midata.`.inner.web_action_local_bak_1108`
 where ch_start_date='2019-12-31';
insert into  midata.web_action_local (    uuid,    visit_id,    app_id,    app_version_id,    agent_id,    os_id,    device_id,    country_id,    region_id,    city_id,    carrier_id,    action_type,    action_name,    view_name,    is_slow,    customer_name,    device_uuid,    start_time,    end_time,    duration,    cpu,    mem,    battery,    visit_start_time,    http_total_count,    http_error_count,    http_slow_count,    http_bytes_sent,    http_bytes_received,    view_loading_time,    view_loading_count,    view_loading_slow_count,    timestamp,    ch_start_date,    browser_id,    ip) SELECT      uuid,      visit_id,      app_id,      app_version_id,      agent_id,      os_id,      device_id,      country_id,      region_id,      city_id,      carrier_id,      action_type,      action_name,      view_name,      is_slow,      customer_name,      device_uuid,      start_time,      end_time,      duration,      cpu,      mem,      battery,      visit_start_time,      http_total_count,      http_error_count,      http_slow_count,      http_bytes_sent,      http_bytes_received,      view_loading_time,      view_loading_count,      view_loading_slow_count,      timestamp,      ch_start_date,      browser_id,      ip FROM midata.`.inner.web_action_local_bak_1108`
 where ch_start_date='2019-12-30';
insert into  midata.web_action_local (    uuid,    visit_id,    app_id,    app_version_id,    agent_id,    os_id,    device_id,    country_id,    region_id,    city_id,    carrier_id,    action_type,    action_name,    view_name,    is_slow,    customer_name,    device_uuid,    start_time,    end_time,    duration,    cpu,    mem,    battery,    visit_start_time,    http_total_count,    http_error_count,    http_slow_count,    http_bytes_sent,    http_bytes_received,    view_loading_time,    view_loading_count,    view_loading_slow_count,    timestamp,    ch_start_date,    browser_id,    ip) SELECT      uuid,      visit_id,      app_id,      app_version_id,      agent_id,      os_id,      device_id,      country_id,      region_id,      city_id,      carrier_id,      action_type,      action_name,      view_name,      is_slow,      customer_name,      device_uuid,      start_time,      end_time,      duration,      cpu,      mem,      battery,      visit_start_time,      http_total_count,      http_error_count,      http_slow_count,      http_bytes_sent,      http_bytes_received,      view_loading_time,      view_loading_count,      view_loading_slow_count,      timestamp,      ch_start_date,      browser_id,      ip FROM midata.`.inner.web_action_local_bak_1108`
 where ch_start_date='2019-12-29';
insert into  midata.web_action_local (    uuid,    visit_id,    app_id,    app_version_id,    agent_id,    os_id,    device_id,    country_id,    region_id,    city_id,    carrier_id,    action_type,    action_name,    view_name,    is_slow,    customer_name,    device_uuid,    start_time,    end_time,    duration,    cpu,    mem,    battery,    visit_start_time,    http_total_count,    http_error_count,    http_slow_count,    http_bytes_sent,    http_bytes_received,    view_loading_time,    view_loading_count,    view_loading_slow_count,    timestamp,    ch_start_date,    browser_id,    ip) SELECT      uuid,      visit_id,      app_id,      app_version_id,      agent_id,      os_id,      device_id,      country_id,      region_id,      city_id,      carrier_id,      action_type,      action_name,      view_name,      is_slow,      customer_name,      device_uuid,      start_time,      end_time,      duration,      cpu,      mem,      battery,      visit_start_time,      http_total_count,      http_error_count,      http_slow_count,      http_bytes_sent,      http_bytes_received,      view_loading_time,      view_loading_count,      view_loading_slow_count,      timestamp,      ch_start_date,      browser_id,      ip FROM midata.`.inner.web_action_local_bak_1108`
 where ch_start_date='2019-12-28';
insert into  midata.web_action_local (    uuid,    visit_id,    app_id,    app_version_id,    agent_id,    os_id,    device_id,    country_id,    region_id,    city_id,    carrier_id,    action_type,    action_name,    view_name,    is_slow,    customer_name,    device_uuid,    start_time,    end_time,    duration,    cpu,    mem,    battery,    visit_start_time,    http_total_count,    http_error_count,    http_slow_count,    http_bytes_sent,    http_bytes_received,    view_loading_time,    view_loading_count,    view_loading_slow_count,    timestamp,    ch_start_date,    browser_id,    ip) SELECT      uuid,      visit_id,      app_id,      app_version_id,      agent_id,      os_id,      device_id,      country_id,      region_id,      city_id,      carrier_id,      action_type,      action_name,      view_name,      is_slow,      customer_name,      device_uuid,      start_time,      end_time,      duration,      cpu,      mem,      battery,      visit_start_time,      http_total_count,      http_error_count,      http_slow_count,      http_bytes_sent,      http_bytes_received,      view_loading_time,      view_loading_count,      view_loading_slow_count,      timestamp,      ch_start_date,      browser_id,      ip FROM midata.`.inner.web_action_local_bak_1108`
 where ch_start_date='2019-12-27';
insert into  midata.web_action_local (    uuid,    visit_id,    app_id,    app_version_id,    agent_id,    os_id,    device_id,    country_id,    region_id,    city_id,    carrier_id,    action_type,    action_name,    view_name,    is_slow,    customer_name,    device_uuid,    start_time,    end_time,    duration,    cpu,    mem,    battery,    visit_start_time,    http_total_count,    http_error_count,    http_slow_count,    http_bytes_sent,    http_bytes_received,    view_loading_time,    view_loading_count,    view_loading_slow_count,    timestamp,    ch_start_date,    browser_id,    ip) SELECT      uuid,      visit_id,      app_id,      app_version_id,      agent_id,      os_id,      device_id,      country_id,      region_id,      city_id,      carrier_id,      action_type,      action_name,      view_name,      is_slow,      customer_name,      device_uuid,      start_time,      end_time,      duration,      cpu,      mem,      battery,      visit_start_time,      http_total_count,      http_error_count,      http_slow_count,      http_bytes_sent,      http_bytes_received,      view_loading_time,      view_loading_count,      view_loading_slow_count,      timestamp,      ch_start_date,      browser_id,      ip FROM midata.`.inner.web_action_local_bak_1108`
 where ch_start_date='2019-12-26';
insert into  midata.web_action_local (    uuid,    visit_id,    app_id,    app_version_id,    agent_id,    os_id,    device_id,    country_id,    region_id,    city_id,    carrier_id,    action_type,    action_name,    view_name,    is_slow,    customer_name,    device_uuid,    start_time,    end_time,    duration,    cpu,    mem,    battery,    visit_start_time,    http_total_count,    http_error_count,    http_slow_count,    http_bytes_sent,    http_bytes_received,    view_loading_time,    view_loading_count,    view_loading_slow_count,    timestamp,    ch_start_date,    browser_id,    ip) SELECT      uuid,      visit_id,      app_id,      app_version_id,      agent_id,      os_id,      device_id,      country_id,      region_id,      city_id,      carrier_id,      action_type,      action_name,      view_name,      is_slow,      customer_name,      device_uuid,      start_time,      end_time,      duration,      cpu,      mem,      battery,      visit_start_time,      http_total_count,      http_error_count,      http_slow_count,      http_bytes_sent,      http_bytes_received,      view_loading_time,      view_loading_count,      view_loading_slow_count,      timestamp,      ch_start_date,      browser_id,      ip FROM midata.`.inner.web_action_local_bak_1108`
 where ch_start_date='2019-12-25';
insert into  midata.web_action_local (    uuid,    visit_id,    app_id,    app_version_id,    agent_id,    os_id,    device_id,    country_id,    region_id,    city_id,    carrier_id,    action_type,    action_name,    view_name,    is_slow,    customer_name,    device_uuid,    start_time,    end_time,    duration,    cpu,    mem,    battery,    visit_start_time,    http_total_count,    http_error_count,    http_slow_count,    http_bytes_sent,    http_bytes_received,    view_loading_time,    view_loading_count,    view_loading_slow_count,    timestamp,    ch_start_date,    browser_id,    ip) SELECT      uuid,      visit_id,      app_id,      app_version_id,      agent_id,      os_id,      device_id,      country_id,      region_id,      city_id,      carrier_id,      action_type,      action_name,      view_name,      is_slow,      customer_name,      device_uuid,      start_time,      end_time,      duration,      cpu,      mem,      battery,      visit_start_time,      http_total_count,      http_error_count,      http_slow_count,      http_bytes_sent,      http_bytes_received,      view_loading_time,      view_loading_count,      view_loading_slow_count,      timestamp,      ch_start_date,      browser_id,      ip FROM midata.`.inner.web_action_local_bak_1108`
 where ch_start_date='2019-12-24';
insert into  midata.web_action_local (    uuid,    visit_id,    app_id,    app_version_id,    agent_id,    os_id,    device_id,    country_id,    region_id,    city_id,    carrier_id,    action_type,    action_name,    view_name,    is_slow,    customer_name,    device_uuid,    start_time,    end_time,    duration,    cpu,    mem,    battery,    visit_start_time,    http_total_count,    http_error_count,    http_slow_count,    http_bytes_sent,    http_bytes_received,    view_loading_time,    view_loading_count,    view_loading_slow_count,    timestamp,    ch_start_date,    browser_id,    ip) SELECT      uuid,      visit_id,      app_id,      app_version_id,      agent_id,      os_id,      device_id,      country_id,      region_id,      city_id,      carrier_id,      action_type,      action_name,      view_name,      is_slow,      customer_name,      device_uuid,      start_time,      end_time,      duration,      cpu,      mem,      battery,      visit_start_time,      http_total_count,      http_error_count,      http_slow_count,      http_bytes_sent,      http_bytes_received,      view_loading_time,      view_loading_count,      view_loading_slow_count,      timestamp,      ch_start_date,      browser_id,      ip FROM midata.`.inner.web_action_local_bak_1108`
 where ch_start_date='2019-12-23';
insert into  midata.web_action_local (    uuid,    visit_id,    app_id,    app_version_id,    agent_id,    os_id,    device_id,    country_id,    region_id,    city_id,    carrier_id,    action_type,    action_name,    view_name,    is_slow,    customer_name,    device_uuid,    start_time,    end_time,    duration,    cpu,    mem,    battery,    visit_start_time,    http_total_count,    http_error_count,    http_slow_count,    http_bytes_sent,    http_bytes_received,    view_loading_time,    view_loading_count,    view_loading_slow_count,    timestamp,    ch_start_date,    browser_id,    ip) SELECT      uuid,      visit_id,      app_id,      app_version_id,      agent_id,      os_id,      device_id,      country_id,      region_id,      city_id,      carrier_id,      action_type,      action_name,      view_name,      is_slow,      customer_name,      device_uuid,      start_time,      end_time,      duration,      cpu,      mem,      battery,      visit_start_time,      http_total_count,      http_error_count,      http_slow_count,      http_bytes_sent,      http_bytes_received,      view_loading_time,      view_loading_count,      view_loading_slow_count,      timestamp,      ch_start_date,      browser_id,      ip FROM midata.`.inner.web_action_local_bak_1108`
 where ch_start_date='2019-12-22';
insert into  midata.web_action_local (    uuid,    visit_id,    app_id,    app_version_id,    agent_id,    os_id,    device_id,    country_id,    region_id,    city_id,    carrier_id,    action_type,    action_name,    view_name,    is_slow,    customer_name,    device_uuid,    start_time,    end_time,    duration,    cpu,    mem,    battery,    visit_start_time,    http_total_count,    http_error_count,    http_slow_count,    http_bytes_sent,    http_bytes_received,    view_loading_time,    view_loading_count,    view_loading_slow_count,    timestamp,    ch_start_date,    browser_id,    ip) SELECT      uuid,      visit_id,      app_id,      app_version_id,      agent_id,      os_id,      device_id,      country_id,      region_id,      city_id,      carrier_id,      action_type,      action_name,      view_name,      is_slow,      customer_name,      device_uuid,      start_time,      end_time,      duration,      cpu,      mem,      battery,      visit_start_time,      http_total_count,      http_error_count,      http_slow_count,      http_bytes_sent,      http_bytes_received,      view_loading_time,      view_loading_count,      view_loading_slow_count,      timestamp,      ch_start_date,      browser_id,      ip FROM midata.`.inner.web_action_local_bak_1108`
 where ch_start_date='2019-12-21';
insert into  midata.web_action_local (    uuid,    visit_id,    app_id,    app_version_id,    agent_id,    os_id,    device_id,    country_id,    region_id,    city_id,    carrier_id,    action_type,    action_name,    view_name,    is_slow,    customer_name,    device_uuid,    start_time,    end_time,    duration,    cpu,    mem,    battery,    visit_start_time,    http_total_count,    http_error_count,    http_slow_count,    http_bytes_sent,    http_bytes_received,    view_loading_time,    view_loading_count,    view_loading_slow_count,    timestamp,    ch_start_date,    browser_id,    ip) SELECT      uuid,      visit_id,      app_id,      app_version_id,      agent_id,      os_id,      device_id,      country_id,      region_id,      city_id,      carrier_id,      action_type,      action_name,      view_name,      is_slow,      customer_name,      device_uuid,      start_time,      end_time,      duration,      cpu,      mem,      battery,      visit_start_time,      http_total_count,      http_error_count,      http_slow_count,      http_bytes_sent,      http_bytes_received,      view_loading_time,      view_loading_count,      view_loading_slow_count,      timestamp,      ch_start_date,      browser_id,      ip FROM midata.`.inner.web_action_local_bak_1108`
 where ch_start_date='2019-12-20';


insert into midata.mi_action_local (    uuid,    visit_id,    app_id,    app_version_id,    agent_id,    os_id,    device_id,    country_id,    region_id,    city_id,    carrier_id,    action_type,    action_name,    view_name,    is_slow,    customer_name,    device_uuid,    start_time,    end_time,    duration,    cpu,    mem,    battery,    visit_start_time,    http_total_count,    http_error_count,    http_slow_count,    http_bytes_sent,    http_bytes_received,    view_loading_time,    view_loading_count,    view_loading_slow_count,    timestamp,    ch_start_date) SELECT      uuid,      visit_id,      app_id,      app_version_id,      agent_id,      os_id,      device_id,      country_id,      region_id,      city_id,      carrier_id,      action_type,      action_name,      view_name,      is_slow,      customer_name,      device_uuid,      start_time,      end_time,      duration,      cpu,      mem,      battery,      visit_start_time,      http_total_count,      http_error_count,      http_slow_count,      http_bytes_sent,      http_bytes_received,      view_loading_time,      view_loading_count,      view_loading_slow_count,      timestamp,      ch_start_date FROM midata.`.inner.mi_action_local_bak_1108`
 where ch_start_date='2020-1-4';
insert into midata.mi_action_local (    uuid,    visit_id,    app_id,    app_version_id,    agent_id,    os_id,    device_id,    country_id,    region_id,    city_id,    carrier_id,    action_type,    action_name,    view_name,    is_slow,    customer_name,    device_uuid,    start_time,    end_time,    duration,    cpu,    mem,    battery,    visit_start_time,    http_total_count,    http_error_count,    http_slow_count,    http_bytes_sent,    http_bytes_received,    view_loading_time,    view_loading_count,    view_loading_slow_count,    timestamp,    ch_start_date) SELECT      uuid,      visit_id,      app_id,      app_version_id,      agent_id,      os_id,      device_id,      country_id,      region_id,      city_id,      carrier_id,      action_type,      action_name,      view_name,      is_slow,      customer_name,      device_uuid,      start_time,      end_time,      duration,      cpu,      mem,      battery,      visit_start_time,      http_total_count,      http_error_count,      http_slow_count,      http_bytes_sent,      http_bytes_received,      view_loading_time,      view_loading_count,      view_loading_slow_count,      timestamp,      ch_start_date FROM midata.`.inner.mi_action_local_bak_1108`
 where ch_start_date='2020-1-3';
insert into midata.mi_action_local (    uuid,    visit_id,    app_id,    app_version_id,    agent_id,    os_id,    device_id,    country_id,    region_id,    city_id,    carrier_id,    action_type,    action_name,    view_name,    is_slow,    customer_name,    device_uuid,    start_time,    end_time,    duration,    cpu,    mem,    battery,    visit_start_time,    http_total_count,    http_error_count,    http_slow_count,    http_bytes_sent,    http_bytes_received,    view_loading_time,    view_loading_count,    view_loading_slow_count,    timestamp,    ch_start_date) SELECT      uuid,      visit_id,      app_id,      app_version_id,      agent_id,      os_id,      device_id,      country_id,      region_id,      city_id,      carrier_id,      action_type,      action_name,      view_name,      is_slow,      customer_name,      device_uuid,      start_time,      end_time,      duration,      cpu,      mem,      battery,      visit_start_time,      http_total_count,      http_error_count,      http_slow_count,      http_bytes_sent,      http_bytes_received,      view_loading_time,      view_loading_count,      view_loading_slow_count,      timestamp,      ch_start_date FROM midata.`.inner.mi_action_local_bak_1108`
 where ch_start_date='2020-1-2';
insert into midata.mi_action_local (    uuid,    visit_id,    app_id,    app_version_id,    agent_id,    os_id,    device_id,    country_id,    region_id,    city_id,    carrier_id,    action_type,    action_name,    view_name,    is_slow,    customer_name,    device_uuid,    start_time,    end_time,    duration,    cpu,    mem,    battery,    visit_start_time,    http_total_count,    http_error_count,    http_slow_count,    http_bytes_sent,    http_bytes_received,    view_loading_time,    view_loading_count,    view_loading_slow_count,    timestamp,    ch_start_date) SELECT      uuid,      visit_id,      app_id,      app_version_id,      agent_id,      os_id,      device_id,      country_id,      region_id,      city_id,      carrier_id,      action_type,      action_name,      view_name,      is_slow,      customer_name,      device_uuid,      start_time,      end_time,      duration,      cpu,      mem,      battery,      visit_start_time,      http_total_count,      http_error_count,      http_slow_count,      http_bytes_sent,      http_bytes_received,      view_loading_time,      view_loading_count,      view_loading_slow_count,      timestamp,      ch_start_date FROM midata.`.inner.mi_action_local_bak_1108`
 where ch_start_date='2020-1-1';
insert into midata.mi_action_local (    uuid,    visit_id,    app_id,    app_version_id,    agent_id,    os_id,    device_id,    country_id,    region_id,    city_id,    carrier_id,    action_type,    action_name,    view_name,    is_slow,    customer_name,    device_uuid,    start_time,    end_time,    duration,    cpu,    mem,    battery,    visit_start_time,    http_total_count,    http_error_count,    http_slow_count,    http_bytes_sent,    http_bytes_received,    view_loading_time,    view_loading_count,    view_loading_slow_count,    timestamp,    ch_start_date) SELECT      uuid,      visit_id,      app_id,      app_version_id,      agent_id,      os_id,      device_id,      country_id,      region_id,      city_id,      carrier_id,      action_type,      action_name,      view_name,      is_slow,      customer_name,      device_uuid,      start_time,      end_time,      duration,      cpu,      mem,      battery,      visit_start_time,      http_total_count,      http_error_count,      http_slow_count,      http_bytes_sent,      http_bytes_received,      view_loading_time,      view_loading_count,      view_loading_slow_count,      timestamp,      ch_start_date FROM midata.`.inner.mi_action_local_bak_1108`
 where ch_start_date='2019-12-31';
insert into midata.mi_action_local (    uuid,    visit_id,    app_id,    app_version_id,    agent_id,    os_id,    device_id,    country_id,    region_id,    city_id,    carrier_id,    action_type,    action_name,    view_name,    is_slow,    customer_name,    device_uuid,    start_time,    end_time,    duration,    cpu,    mem,    battery,    visit_start_time,    http_total_count,    http_error_count,    http_slow_count,    http_bytes_sent,    http_bytes_received,    view_loading_time,    view_loading_count,    view_loading_slow_count,    timestamp,    ch_start_date) SELECT      uuid,      visit_id,      app_id,      app_version_id,      agent_id,      os_id,      device_id,      country_id,      region_id,      city_id,      carrier_id,      action_type,      action_name,      view_name,      is_slow,      customer_name,      device_uuid,      start_time,      end_time,      duration,      cpu,      mem,      battery,      visit_start_time,      http_total_count,      http_error_count,      http_slow_count,      http_bytes_sent,      http_bytes_received,      view_loading_time,      view_loading_count,      view_loading_slow_count,      timestamp,      ch_start_date FROM midata.`.inner.mi_action_local_bak_1108`
 where ch_start_date='2019-12-30';
insert into midata.mi_action_local (    uuid,    visit_id,    app_id,    app_version_id,    agent_id,    os_id,    device_id,    country_id,    region_id,    city_id,    carrier_id,    action_type,    action_name,    view_name,    is_slow,    customer_name,    device_uuid,    start_time,    end_time,    duration,    cpu,    mem,    battery,    visit_start_time,    http_total_count,    http_error_count,    http_slow_count,    http_bytes_sent,    http_bytes_received,    view_loading_time,    view_loading_count,    view_loading_slow_count,    timestamp,    ch_start_date) SELECT      uuid,      visit_id,      app_id,      app_version_id,      agent_id,      os_id,      device_id,      country_id,      region_id,      city_id,      carrier_id,      action_type,      action_name,      view_name,      is_slow,      customer_name,      device_uuid,      start_time,      end_time,      duration,      cpu,      mem,      battery,      visit_start_time,      http_total_count,      http_error_count,      http_slow_count,      http_bytes_sent,      http_bytes_received,      view_loading_time,      view_loading_count,      view_loading_slow_count,      timestamp,      ch_start_date FROM midata.`.inner.mi_action_local_bak_1108`
 where ch_start_date='2019-12-29';
insert into midata.mi_action_local (    uuid,    visit_id,    app_id,    app_version_id,    agent_id,    os_id,    device_id,    country_id,    region_id,    city_id,    carrier_id,    action_type,    action_name,    view_name,    is_slow,    customer_name,    device_uuid,    start_time,    end_time,    duration,    cpu,    mem,    battery,    visit_start_time,    http_total_count,    http_error_count,    http_slow_count,    http_bytes_sent,    http_bytes_received,    view_loading_time,    view_loading_count,    view_loading_slow_count,    timestamp,    ch_start_date) SELECT      uuid,      visit_id,      app_id,      app_version_id,      agent_id,      os_id,      device_id,      country_id,      region_id,      city_id,      carrier_id,      action_type,      action_name,      view_name,      is_slow,      customer_name,      device_uuid,      start_time,      end_time,      duration,      cpu,      mem,      battery,      visit_start_time,      http_total_count,      http_error_count,      http_slow_count,      http_bytes_sent,      http_bytes_received,      view_loading_time,      view_loading_count,      view_loading_slow_count,      timestamp,      ch_start_date FROM midata.`.inner.mi_action_local_bak_1108`
 where ch_start_date='2019-12-28';
insert into midata.mi_action_local (    uuid,    visit_id,    app_id,    app_version_id,    agent_id,    os_id,    device_id,    country_id,    region_id,    city_id,    carrier_id,    action_type,    action_name,    view_name,    is_slow,    customer_name,    device_uuid,    start_time,    end_time,    duration,    cpu,    mem,    battery,    visit_start_time,    http_total_count,    http_error_count,    http_slow_count,    http_bytes_sent,    http_bytes_received,    view_loading_time,    view_loading_count,    view_loading_slow_count,    timestamp,    ch_start_date) SELECT      uuid,      visit_id,      app_id,      app_version_id,      agent_id,      os_id,      device_id,      country_id,      region_id,      city_id,      carrier_id,      action_type,      action_name,      view_name,      is_slow,      customer_name,      device_uuid,      start_time,      end_time,      duration,      cpu,      mem,      battery,      visit_start_time,      http_total_count,      http_error_count,      http_slow_count,      http_bytes_sent,      http_bytes_received,      view_loading_time,      view_loading_count,      view_loading_slow_count,      timestamp,      ch_start_date FROM midata.`.inner.mi_action_local_bak_1108`
 where ch_start_date='2019-12-27';
insert into midata.mi_action_local (    uuid,    visit_id,    app_id,    app_version_id,    agent_id,    os_id,    device_id,    country_id,    region_id,    city_id,    carrier_id,    action_type,    action_name,    view_name,    is_slow,    customer_name,    device_uuid,    start_time,    end_time,    duration,    cpu,    mem,    battery,    visit_start_time,    http_total_count,    http_error_count,    http_slow_count,    http_bytes_sent,    http_bytes_received,    view_loading_time,    view_loading_count,    view_loading_slow_count,    timestamp,    ch_start_date) SELECT      uuid,      visit_id,      app_id,      app_version_id,      agent_id,      os_id,      device_id,      country_id,      region_id,      city_id,      carrier_id,      action_type,      action_name,      view_name,      is_slow,      customer_name,      device_uuid,      start_time,      end_time,      duration,      cpu,      mem,      battery,      visit_start_time,      http_total_count,      http_error_count,      http_slow_count,      http_bytes_sent,      http_bytes_received,      view_loading_time,      view_loading_count,      view_loading_slow_count,      timestamp,      ch_start_date FROM midata.`.inner.mi_action_local_bak_1108`
 where ch_start_date='2019-12-26';
insert into midata.mi_action_local (    uuid,    visit_id,    app_id,    app_version_id,    agent_id,    os_id,    device_id,    country_id,    region_id,    city_id,    carrier_id,    action_type,    action_name,    view_name,    is_slow,    customer_name,    device_uuid,    start_time,    end_time,    duration,    cpu,    mem,    battery,    visit_start_time,    http_total_count,    http_error_count,    http_slow_count,    http_bytes_sent,    http_bytes_received,    view_loading_time,    view_loading_count,    view_loading_slow_count,    timestamp,    ch_start_date) SELECT      uuid,      visit_id,      app_id,      app_version_id,      agent_id,      os_id,      device_id,      country_id,      region_id,      city_id,      carrier_id,      action_type,      action_name,      view_name,      is_slow,      customer_name,      device_uuid,      start_time,      end_time,      duration,      cpu,      mem,      battery,      visit_start_time,      http_total_count,      http_error_count,      http_slow_count,      http_bytes_sent,      http_bytes_received,      view_loading_time,      view_loading_count,      view_loading_slow_count,      timestamp,      ch_start_date FROM midata.`.inner.mi_action_local_bak_1108`
 where ch_start_date='2019-12-25';
insert into midata.mi_action_local (    uuid,    visit_id,    app_id,    app_version_id,    agent_id,    os_id,    device_id,    country_id,    region_id,    city_id,    carrier_id,    action_type,    action_name,    view_name,    is_slow,    customer_name,    device_uuid,    start_time,    end_time,    duration,    cpu,    mem,    battery,    visit_start_time,    http_total_count,    http_error_count,    http_slow_count,    http_bytes_sent,    http_bytes_received,    view_loading_time,    view_loading_count,    view_loading_slow_count,    timestamp,    ch_start_date) SELECT      uuid,      visit_id,      app_id,      app_version_id,      agent_id,      os_id,      device_id,      country_id,      region_id,      city_id,      carrier_id,      action_type,      action_name,      view_name,      is_slow,      customer_name,      device_uuid,      start_time,      end_time,      duration,      cpu,      mem,      battery,      visit_start_time,      http_total_count,      http_error_count,      http_slow_count,      http_bytes_sent,      http_bytes_received,      view_loading_time,      view_loading_count,      view_loading_slow_count,      timestamp,      ch_start_date FROM midata.`.inner.mi_action_local_bak_1108`
 where ch_start_date='2019-12-24';
insert into midata.mi_action_local (    uuid,    visit_id,    app_id,    app_version_id,    agent_id,    os_id,    device_id,    country_id,    region_id,    city_id,    carrier_id,    action_type,    action_name,    view_name,    is_slow,    customer_name,    device_uuid,    start_time,    end_time,    duration,    cpu,    mem,    battery,    visit_start_time,    http_total_count,    http_error_count,    http_slow_count,    http_bytes_sent,    http_bytes_received,    view_loading_time,    view_loading_count,    view_loading_slow_count,    timestamp,    ch_start_date) SELECT      uuid,      visit_id,      app_id,      app_version_id,      agent_id,      os_id,      device_id,      country_id,      region_id,      city_id,      carrier_id,      action_type,      action_name,      view_name,      is_slow,      customer_name,      device_uuid,      start_time,      end_time,      duration,      cpu,      mem,      battery,      visit_start_time,      http_total_count,      http_error_count,      http_slow_count,      http_bytes_sent,      http_bytes_received,      view_loading_time,      view_loading_count,      view_loading_slow_count,      timestamp,      ch_start_date FROM midata.`.inner.mi_action_local_bak_1108`
 where ch_start_date='2019-12-23';
insert into midata.mi_action_local (    uuid,    visit_id,    app_id,    app_version_id,    agent_id,    os_id,    device_id,    country_id,    region_id,    city_id,    carrier_id,    action_type,    action_name,    view_name,    is_slow,    customer_name,    device_uuid,    start_time,    end_time,    duration,    cpu,    mem,    battery,    visit_start_time,    http_total_count,    http_error_count,    http_slow_count,    http_bytes_sent,    http_bytes_received,    view_loading_time,    view_loading_count,    view_loading_slow_count,    timestamp,    ch_start_date) SELECT      uuid,      visit_id,      app_id,      app_version_id,      agent_id,      os_id,      device_id,      country_id,      region_id,      city_id,      carrier_id,      action_type,      action_name,      view_name,      is_slow,      customer_name,      device_uuid,      start_time,      end_time,      duration,      cpu,      mem,      battery,      visit_start_time,      http_total_count,      http_error_count,      http_slow_count,      http_bytes_sent,      http_bytes_received,      view_loading_time,      view_loading_count,      view_loading_slow_count,      timestamp,      ch_start_date FROM midata.`.inner.mi_action_local_bak_1108`
 where ch_start_date='2019-12-22';
insert into midata.mi_action_local (    uuid,    visit_id,    app_id,    app_version_id,    agent_id,    os_id,    device_id,    country_id,    region_id,    city_id,    carrier_id,    action_type,    action_name,    view_name,    is_slow,    customer_name,    device_uuid,    start_time,    end_time,    duration,    cpu,    mem,    battery,    visit_start_time,    http_total_count,    http_error_count,    http_slow_count,    http_bytes_sent,    http_bytes_received,    view_loading_time,    view_loading_count,    view_loading_slow_count,    timestamp,    ch_start_date) SELECT      uuid,      visit_id,      app_id,      app_version_id,      agent_id,      os_id,      device_id,      country_id,      region_id,      city_id,      carrier_id,      action_type,      action_name,      view_name,      is_slow,      customer_name,      device_uuid,      start_time,      end_time,      duration,      cpu,      mem,      battery,      visit_start_time,      http_total_count,      http_error_count,      http_slow_count,      http_bytes_sent,      http_bytes_received,      view_loading_time,      view_loading_count,      view_loading_slow_count,      timestamp,      ch_start_date FROM midata.`.inner.mi_action_local_bak_1108`
 where ch_start_date='2019-12-21';
insert into midata.mi_action_local (    uuid,    visit_id,    app_id,    app_version_id,    agent_id,    os_id,    device_id,    country_id,    region_id,    city_id,    carrier_id,    action_type,    action_name,    view_name,    is_slow,    customer_name,    device_uuid,    start_time,    end_time,    duration,    cpu,    mem,    battery,    visit_start_time,    http_total_count,    http_error_count,    http_slow_count,    http_bytes_sent,    http_bytes_received,    view_loading_time,    view_loading_count,    view_loading_slow_count,    timestamp,    ch_start_date) SELECT      uuid,      visit_id,      app_id,      app_version_id,      agent_id,      os_id,      device_id,      country_id,      region_id,      city_id,      carrier_id,      action_type,      action_name,      view_name,      is_slow,      customer_name,      device_uuid,      start_time,      end_time,      duration,      cpu,      mem,      battery,      visit_start_time,      http_total_count,      http_error_count,      http_slow_count,      http_bytes_sent,      http_bytes_received,      view_loading_time,      view_loading_count,      view_loading_slow_count,      timestamp,      ch_start_date FROM midata.`.inner.mi_action_local_bak_1108`
 where ch_start_date='2019-12-20';


insert into midata.web_action_agg_customer_1m_local (    app_id ,    app_version_id ,    os_id ,    device_id ,    country_id ,    region_id ,    city_id ,    carrier_id ,    customer_name ,    device_uuid ,    action_type ,    action_name ,    view_name ,    ch_start_date ,    timestamp ,    duration ,    error_count ,    slow_count ,    total_count ,    bytes_sent ,    bytes_received ,    action_count ,    view_loading_time ,    view_loading_count ,    view_loading_slow_count) SELECT      app_id,      app_version_id,      os_id,      device_id,      country_id,      region_id,      city_id,      carrier_id,      customer_name,      device_uuid,      action_type,      action_name,      view_name,      ch_start_date,      toUInt64(intDiv(timestamp, 60000) * 60000) AS timestamp,      sumState(duration) AS duration,      countIfState(http_error_count > 0) AS error_count,      sumState(is_slow) AS slow_count,      countState() AS total_count,      sumState(http_bytes_sent) AS bytes_sent,      sumState(http_bytes_received) AS bytes_received,      countState() AS action_count,      sumState(view_loading_time) AS view_loading_time,      sumState(view_loading_count) AS view_loading_count,      sumState(view_loading_slow_count) AS view_loading_slow_count FROM midata.web_action_local
 where ch_start_date='2020-1-4'
GROUP BY app_id, app_version_id, os_id, device_id, country_id, region_id, city_id, carrier_id, customer_name, device_uuid, action_type, action_name, view_name, ch_start_date, timestamp;
insert into midata.web_action_agg_customer_1m_local (    app_id ,    app_version_id ,    os_id ,    device_id ,    country_id ,    region_id ,    city_id ,    carrier_id ,    customer_name ,    device_uuid ,    action_type ,    action_name ,    view_name ,    ch_start_date ,    timestamp ,    duration ,    error_count ,    slow_count ,    total_count ,    bytes_sent ,    bytes_received ,    action_count ,    view_loading_time ,    view_loading_count ,    view_loading_slow_count) SELECT      app_id,      app_version_id,      os_id,      device_id,      country_id,      region_id,      city_id,      carrier_id,      customer_name,      device_uuid,      action_type,      action_name,      view_name,      ch_start_date,      toUInt64(intDiv(timestamp, 60000) * 60000) AS timestamp,      sumState(duration) AS duration,      countIfState(http_error_count > 0) AS error_count,      sumState(is_slow) AS slow_count,      countState() AS total_count,      sumState(http_bytes_sent) AS bytes_sent,      sumState(http_bytes_received) AS bytes_received,      countState() AS action_count,      sumState(view_loading_time) AS view_loading_time,      sumState(view_loading_count) AS view_loading_count,      sumState(view_loading_slow_count) AS view_loading_slow_count FROM midata.web_action_local
 where ch_start_date='2020-1-3'
GROUP BY app_id, app_version_id, os_id, device_id, country_id, region_id, city_id, carrier_id, customer_name, device_uuid, action_type, action_name, view_name, ch_start_date, timestamp;
insert into midata.web_action_agg_customer_1m_local (    app_id ,    app_version_id ,    os_id ,    device_id ,    country_id ,    region_id ,    city_id ,    carrier_id ,    customer_name ,    device_uuid ,    action_type ,    action_name ,    view_name ,    ch_start_date ,    timestamp ,    duration ,    error_count ,    slow_count ,    total_count ,    bytes_sent ,    bytes_received ,    action_count ,    view_loading_time ,    view_loading_count ,    view_loading_slow_count) SELECT      app_id,      app_version_id,      os_id,      device_id,      country_id,      region_id,      city_id,      carrier_id,      customer_name,      device_uuid,      action_type,      action_name,      view_name,      ch_start_date,      toUInt64(intDiv(timestamp, 60000) * 60000) AS timestamp,      sumState(duration) AS duration,      countIfState(http_error_count > 0) AS error_count,      sumState(is_slow) AS slow_count,      countState() AS total_count,      sumState(http_bytes_sent) AS bytes_sent,      sumState(http_bytes_received) AS bytes_received,      countState() AS action_count,      sumState(view_loading_time) AS view_loading_time,      sumState(view_loading_count) AS view_loading_count,      sumState(view_loading_slow_count) AS view_loading_slow_count FROM midata.web_action_local
 where ch_start_date='2020-1-2'
GROUP BY app_id, app_version_id, os_id, device_id, country_id, region_id, city_id, carrier_id, customer_name, device_uuid, action_type, action_name, view_name, ch_start_date, timestamp;
insert into midata.web_action_agg_customer_1m_local (    app_id ,    app_version_id ,    os_id ,    device_id ,    country_id ,    region_id ,    city_id ,    carrier_id ,    customer_name ,    device_uuid ,    action_type ,    action_name ,    view_name ,    ch_start_date ,    timestamp ,    duration ,    error_count ,    slow_count ,    total_count ,    bytes_sent ,    bytes_received ,    action_count ,    view_loading_time ,    view_loading_count ,    view_loading_slow_count) SELECT      app_id,      app_version_id,      os_id,      device_id,      country_id,      region_id,      city_id,      carrier_id,      customer_name,      device_uuid,      action_type,      action_name,      view_name,      ch_start_date,      toUInt64(intDiv(timestamp, 60000) * 60000) AS timestamp,      sumState(duration) AS duration,      countIfState(http_error_count > 0) AS error_count,      sumState(is_slow) AS slow_count,      countState() AS total_count,      sumState(http_bytes_sent) AS bytes_sent,      sumState(http_bytes_received) AS bytes_received,      countState() AS action_count,      sumState(view_loading_time) AS view_loading_time,      sumState(view_loading_count) AS view_loading_count,      sumState(view_loading_slow_count) AS view_loading_slow_count FROM midata.web_action_local
 where ch_start_date='2020-1-1'
GROUP BY app_id, app_version_id, os_id, device_id, country_id, region_id, city_id, carrier_id, customer_name, device_uuid, action_type, action_name, view_name, ch_start_date, timestamp;
insert into midata.web_action_agg_customer_1m_local (    app_id ,    app_version_id ,    os_id ,    device_id ,    country_id ,    region_id ,    city_id ,    carrier_id ,    customer_name ,    device_uuid ,    action_type ,    action_name ,    view_name ,    ch_start_date ,    timestamp ,    duration ,    error_count ,    slow_count ,    total_count ,    bytes_sent ,    bytes_received ,    action_count ,    view_loading_time ,    view_loading_count ,    view_loading_slow_count) SELECT      app_id,      app_version_id,      os_id,      device_id,      country_id,      region_id,      city_id,      carrier_id,      customer_name,      device_uuid,      action_type,      action_name,      view_name,      ch_start_date,      toUInt64(intDiv(timestamp, 60000) * 60000) AS timestamp,      sumState(duration) AS duration,      countIfState(http_error_count > 0) AS error_count,      sumState(is_slow) AS slow_count,      countState() AS total_count,      sumState(http_bytes_sent) AS bytes_sent,      sumState(http_bytes_received) AS bytes_received,      countState() AS action_count,      sumState(view_loading_time) AS view_loading_time,      sumState(view_loading_count) AS view_loading_count,      sumState(view_loading_slow_count) AS view_loading_slow_count FROM midata.web_action_local
 where ch_start_date='2019-12-31'
GROUP BY app_id, app_version_id, os_id, device_id, country_id, region_id, city_id, carrier_id, customer_name, device_uuid, action_type, action_name, view_name, ch_start_date, timestamp;
insert into midata.web_action_agg_customer_1m_local (    app_id ,    app_version_id ,    os_id ,    device_id ,    country_id ,    region_id ,    city_id ,    carrier_id ,    customer_name ,    device_uuid ,    action_type ,    action_name ,    view_name ,    ch_start_date ,    timestamp ,    duration ,    error_count ,    slow_count ,    total_count ,    bytes_sent ,    bytes_received ,    action_count ,    view_loading_time ,    view_loading_count ,    view_loading_slow_count) SELECT      app_id,      app_version_id,      os_id,      device_id,      country_id,      region_id,      city_id,      carrier_id,      customer_name,      device_uuid,      action_type,      action_name,      view_name,      ch_start_date,      toUInt64(intDiv(timestamp, 60000) * 60000) AS timestamp,      sumState(duration) AS duration,      countIfState(http_error_count > 0) AS error_count,      sumState(is_slow) AS slow_count,      countState() AS total_count,      sumState(http_bytes_sent) AS bytes_sent,      sumState(http_bytes_received) AS bytes_received,      countState() AS action_count,      sumState(view_loading_time) AS view_loading_time,      sumState(view_loading_count) AS view_loading_count,      sumState(view_loading_slow_count) AS view_loading_slow_count FROM midata.web_action_local
 where ch_start_date='2019-12-30'
GROUP BY app_id, app_version_id, os_id, device_id, country_id, region_id, city_id, carrier_id, customer_name, device_uuid, action_type, action_name, view_name, ch_start_date, timestamp;
insert into midata.web_action_agg_customer_1m_local (    app_id ,    app_version_id ,    os_id ,    device_id ,    country_id ,    region_id ,    city_id ,    carrier_id ,    customer_name ,    device_uuid ,    action_type ,    action_name ,    view_name ,    ch_start_date ,    timestamp ,    duration ,    error_count ,    slow_count ,    total_count ,    bytes_sent ,    bytes_received ,    action_count ,    view_loading_time ,    view_loading_count ,    view_loading_slow_count) SELECT      app_id,      app_version_id,      os_id,      device_id,      country_id,      region_id,      city_id,      carrier_id,      customer_name,      device_uuid,      action_type,      action_name,      view_name,      ch_start_date,      toUInt64(intDiv(timestamp, 60000) * 60000) AS timestamp,      sumState(duration) AS duration,      countIfState(http_error_count > 0) AS error_count,      sumState(is_slow) AS slow_count,      countState() AS total_count,      sumState(http_bytes_sent) AS bytes_sent,      sumState(http_bytes_received) AS bytes_received,      countState() AS action_count,      sumState(view_loading_time) AS view_loading_time,      sumState(view_loading_count) AS view_loading_count,      sumState(view_loading_slow_count) AS view_loading_slow_count FROM midata.web_action_local
 where ch_start_date='2019-12-29'
GROUP BY app_id, app_version_id, os_id, device_id, country_id, region_id, city_id, carrier_id, customer_name, device_uuid, action_type, action_name, view_name, ch_start_date, timestamp;
insert into midata.web_action_agg_customer_1m_local (    app_id ,    app_version_id ,    os_id ,    device_id ,    country_id ,    region_id ,    city_id ,    carrier_id ,    customer_name ,    device_uuid ,    action_type ,    action_name ,    view_name ,    ch_start_date ,    timestamp ,    duration ,    error_count ,    slow_count ,    total_count ,    bytes_sent ,    bytes_received ,    action_count ,    view_loading_time ,    view_loading_count ,    view_loading_slow_count) SELECT      app_id,      app_version_id,      os_id,      device_id,      country_id,      region_id,      city_id,      carrier_id,      customer_name,      device_uuid,      action_type,      action_name,      view_name,      ch_start_date,      toUInt64(intDiv(timestamp, 60000) * 60000) AS timestamp,      sumState(duration) AS duration,      countIfState(http_error_count > 0) AS error_count,      sumState(is_slow) AS slow_count,      countState() AS total_count,      sumState(http_bytes_sent) AS bytes_sent,      sumState(http_bytes_received) AS bytes_received,      countState() AS action_count,      sumState(view_loading_time) AS view_loading_time,      sumState(view_loading_count) AS view_loading_count,      sumState(view_loading_slow_count) AS view_loading_slow_count FROM midata.web_action_local
 where ch_start_date='2019-12-28'
GROUP BY app_id, app_version_id, os_id, device_id, country_id, region_id, city_id, carrier_id, customer_name, device_uuid, action_type, action_name, view_name, ch_start_date, timestamp;
insert into midata.web_action_agg_customer_1m_local (    app_id ,    app_version_id ,    os_id ,    device_id ,    country_id ,    region_id ,    city_id ,    carrier_id ,    customer_name ,    device_uuid ,    action_type ,    action_name ,    view_name ,    ch_start_date ,    timestamp ,    duration ,    error_count ,    slow_count ,    total_count ,    bytes_sent ,    bytes_received ,    action_count ,    view_loading_time ,    view_loading_count ,    view_loading_slow_count) SELECT      app_id,      app_version_id,      os_id,      device_id,      country_id,      region_id,      city_id,      carrier_id,      customer_name,      device_uuid,      action_type,      action_name,      view_name,      ch_start_date,      toUInt64(intDiv(timestamp, 60000) * 60000) AS timestamp,      sumState(duration) AS duration,      countIfState(http_error_count > 0) AS error_count,      sumState(is_slow) AS slow_count,      countState() AS total_count,      sumState(http_bytes_sent) AS bytes_sent,      sumState(http_bytes_received) AS bytes_received,      countState() AS action_count,      sumState(view_loading_time) AS view_loading_time,      sumState(view_loading_count) AS view_loading_count,      sumState(view_loading_slow_count) AS view_loading_slow_count FROM midata.web_action_local
 where ch_start_date='2019-12-27'
GROUP BY app_id, app_version_id, os_id, device_id, country_id, region_id, city_id, carrier_id, customer_name, device_uuid, action_type, action_name, view_name, ch_start_date, timestamp;
insert into midata.web_action_agg_customer_1m_local (    app_id ,    app_version_id ,    os_id ,    device_id ,    country_id ,    region_id ,    city_id ,    carrier_id ,    customer_name ,    device_uuid ,    action_type ,    action_name ,    view_name ,    ch_start_date ,    timestamp ,    duration ,    error_count ,    slow_count ,    total_count ,    bytes_sent ,    bytes_received ,    action_count ,    view_loading_time ,    view_loading_count ,    view_loading_slow_count) SELECT      app_id,      app_version_id,      os_id,      device_id,      country_id,      region_id,      city_id,      carrier_id,      customer_name,      device_uuid,      action_type,      action_name,      view_name,      ch_start_date,      toUInt64(intDiv(timestamp, 60000) * 60000) AS timestamp,      sumState(duration) AS duration,      countIfState(http_error_count > 0) AS error_count,      sumState(is_slow) AS slow_count,      countState() AS total_count,      sumState(http_bytes_sent) AS bytes_sent,      sumState(http_bytes_received) AS bytes_received,      countState() AS action_count,      sumState(view_loading_time) AS view_loading_time,      sumState(view_loading_count) AS view_loading_count,      sumState(view_loading_slow_count) AS view_loading_slow_count FROM midata.web_action_local
 where ch_start_date='2019-12-26'
GROUP BY app_id, app_version_id, os_id, device_id, country_id, region_id, city_id, carrier_id, customer_name, device_uuid, action_type, action_name, view_name, ch_start_date, timestamp;
insert into midata.web_action_agg_customer_1m_local (    app_id ,    app_version_id ,    os_id ,    device_id ,    country_id ,    region_id ,    city_id ,    carrier_id ,    customer_name ,    device_uuid ,    action_type ,    action_name ,    view_name ,    ch_start_date ,    timestamp ,    duration ,    error_count ,    slow_count ,    total_count ,    bytes_sent ,    bytes_received ,    action_count ,    view_loading_time ,    view_loading_count ,    view_loading_slow_count) SELECT      app_id,      app_version_id,      os_id,      device_id,      country_id,      region_id,      city_id,      carrier_id,      customer_name,      device_uuid,      action_type,      action_name,      view_name,      ch_start_date,      toUInt64(intDiv(timestamp, 60000) * 60000) AS timestamp,      sumState(duration) AS duration,      countIfState(http_error_count > 0) AS error_count,      sumState(is_slow) AS slow_count,      countState() AS total_count,      sumState(http_bytes_sent) AS bytes_sent,      sumState(http_bytes_received) AS bytes_received,      countState() AS action_count,      sumState(view_loading_time) AS view_loading_time,      sumState(view_loading_count) AS view_loading_count,      sumState(view_loading_slow_count) AS view_loading_slow_count FROM midata.web_action_local
 where ch_start_date='2019-12-25'
GROUP BY app_id, app_version_id, os_id, device_id, country_id, region_id, city_id, carrier_id, customer_name, device_uuid, action_type, action_name, view_name, ch_start_date, timestamp;
insert into midata.web_action_agg_customer_1m_local (    app_id ,    app_version_id ,    os_id ,    device_id ,    country_id ,    region_id ,    city_id ,    carrier_id ,    customer_name ,    device_uuid ,    action_type ,    action_name ,    view_name ,    ch_start_date ,    timestamp ,    duration ,    error_count ,    slow_count ,    total_count ,    bytes_sent ,    bytes_received ,    action_count ,    view_loading_time ,    view_loading_count ,    view_loading_slow_count) SELECT      app_id,      app_version_id,      os_id,      device_id,      country_id,      region_id,      city_id,      carrier_id,      customer_name,      device_uuid,      action_type,      action_name,      view_name,      ch_start_date,      toUInt64(intDiv(timestamp, 60000) * 60000) AS timestamp,      sumState(duration) AS duration,      countIfState(http_error_count > 0) AS error_count,      sumState(is_slow) AS slow_count,      countState() AS total_count,      sumState(http_bytes_sent) AS bytes_sent,      sumState(http_bytes_received) AS bytes_received,      countState() AS action_count,      sumState(view_loading_time) AS view_loading_time,      sumState(view_loading_count) AS view_loading_count,      sumState(view_loading_slow_count) AS view_loading_slow_count FROM midata.web_action_local
 where ch_start_date='2019-12-24'
GROUP BY app_id, app_version_id, os_id, device_id, country_id, region_id, city_id, carrier_id, customer_name, device_uuid, action_type, action_name, view_name, ch_start_date, timestamp;
insert into midata.web_action_agg_customer_1m_local (    app_id ,    app_version_id ,    os_id ,    device_id ,    country_id ,    region_id ,    city_id ,    carrier_id ,    customer_name ,    device_uuid ,    action_type ,    action_name ,    view_name ,    ch_start_date ,    timestamp ,    duration ,    error_count ,    slow_count ,    total_count ,    bytes_sent ,    bytes_received ,    action_count ,    view_loading_time ,    view_loading_count ,    view_loading_slow_count) SELECT      app_id,      app_version_id,      os_id,      device_id,      country_id,      region_id,      city_id,      carrier_id,      customer_name,      device_uuid,      action_type,      action_name,      view_name,      ch_start_date,      toUInt64(intDiv(timestamp, 60000) * 60000) AS timestamp,      sumState(duration) AS duration,      countIfState(http_error_count > 0) AS error_count,      sumState(is_slow) AS slow_count,      countState() AS total_count,      sumState(http_bytes_sent) AS bytes_sent,      sumState(http_bytes_received) AS bytes_received,      countState() AS action_count,      sumState(view_loading_time) AS view_loading_time,      sumState(view_loading_count) AS view_loading_count,      sumState(view_loading_slow_count) AS view_loading_slow_count FROM midata.web_action_local
 where ch_start_date='2019-12-23'
GROUP BY app_id, app_version_id, os_id, device_id, country_id, region_id, city_id, carrier_id, customer_name, device_uuid, action_type, action_name, view_name, ch_start_date, timestamp;
insert into midata.web_action_agg_customer_1m_local (    app_id ,    app_version_id ,    os_id ,    device_id ,    country_id ,    region_id ,    city_id ,    carrier_id ,    customer_name ,    device_uuid ,    action_type ,    action_name ,    view_name ,    ch_start_date ,    timestamp ,    duration ,    error_count ,    slow_count ,    total_count ,    bytes_sent ,    bytes_received ,    action_count ,    view_loading_time ,    view_loading_count ,    view_loading_slow_count) SELECT      app_id,      app_version_id,      os_id,      device_id,      country_id,      region_id,      city_id,      carrier_id,      customer_name,      device_uuid,      action_type,      action_name,      view_name,      ch_start_date,      toUInt64(intDiv(timestamp, 60000) * 60000) AS timestamp,      sumState(duration) AS duration,      countIfState(http_error_count > 0) AS error_count,      sumState(is_slow) AS slow_count,      countState() AS total_count,      sumState(http_bytes_sent) AS bytes_sent,      sumState(http_bytes_received) AS bytes_received,      countState() AS action_count,      sumState(view_loading_time) AS view_loading_time,      sumState(view_loading_count) AS view_loading_count,      sumState(view_loading_slow_count) AS view_loading_slow_count FROM midata.web_action_local
 where ch_start_date='2019-12-22'
GROUP BY app_id, app_version_id, os_id, device_id, country_id, region_id, city_id, carrier_id, customer_name, device_uuid, action_type, action_name, view_name, ch_start_date, timestamp;
insert into midata.web_action_agg_customer_1m_local (    app_id ,    app_version_id ,    os_id ,    device_id ,    country_id ,    region_id ,    city_id ,    carrier_id ,    customer_name ,    device_uuid ,    action_type ,    action_name ,    view_name ,    ch_start_date ,    timestamp ,    duration ,    error_count ,    slow_count ,    total_count ,    bytes_sent ,    bytes_received ,    action_count ,    view_loading_time ,    view_loading_count ,    view_loading_slow_count) SELECT      app_id,      app_version_id,      os_id,      device_id,      country_id,      region_id,      city_id,      carrier_id,      customer_name,      device_uuid,      action_type,      action_name,      view_name,      ch_start_date,      toUInt64(intDiv(timestamp, 60000) * 60000) AS timestamp,      sumState(duration) AS duration,      countIfState(http_error_count > 0) AS error_count,      sumState(is_slow) AS slow_count,      countState() AS total_count,      sumState(http_bytes_sent) AS bytes_sent,      sumState(http_bytes_received) AS bytes_received,      countState() AS action_count,      sumState(view_loading_time) AS view_loading_time,      sumState(view_loading_count) AS view_loading_count,      sumState(view_loading_slow_count) AS view_loading_slow_count FROM midata.web_action_local
 where ch_start_date='2019-12-21'
GROUP BY app_id, app_version_id, os_id, device_id, country_id, region_id, city_id, carrier_id, customer_name, device_uuid, action_type, action_name, view_name, ch_start_date, timestamp;
insert into midata.web_action_agg_customer_1m_local (    app_id ,    app_version_id ,    os_id ,    device_id ,    country_id ,    region_id ,    city_id ,    carrier_id ,    customer_name ,    device_uuid ,    action_type ,    action_name ,    view_name ,    ch_start_date ,    timestamp ,    duration ,    error_count ,    slow_count ,    total_count ,    bytes_sent ,    bytes_received ,    action_count ,    view_loading_time ,    view_loading_count ,    view_loading_slow_count) SELECT      app_id,      app_version_id,      os_id,      device_id,      country_id,      region_id,      city_id,      carrier_id,      customer_name,      device_uuid,      action_type,      action_name,      view_name,      ch_start_date,      toUInt64(intDiv(timestamp, 60000) * 60000) AS timestamp,      sumState(duration) AS duration,      countIfState(http_error_count > 0) AS error_count,      sumState(is_slow) AS slow_count,      countState() AS total_count,      sumState(http_bytes_sent) AS bytes_sent,      sumState(http_bytes_received) AS bytes_received,      countState() AS action_count,      sumState(view_loading_time) AS view_loading_time,      sumState(view_loading_count) AS view_loading_count,      sumState(view_loading_slow_count) AS view_loading_slow_count FROM midata.web_action_local
 where ch_start_date='2019-12-20'
GROUP BY app_id, app_version_id, os_id, device_id, country_id, region_id, city_id, carrier_id, customer_name, device_uuid, action_type, action_name, view_name, ch_start_date, timestamp;


insert into midata.mi_action_agg_customer_1m_local (    app_id ,    app_version_id ,    os_id ,    device_id ,    country_id ,    region_id ,    city_id ,    carrier_id ,    customer_name ,    device_uuid ,    action_type ,    action_name ,    view_name ,    ch_start_date ,    timestamp ,    duration ,    error_count ,    slow_count ,    total_count ,    bytes_sent ,    bytes_received) SELECT      app_id,      app_version_id,      os_id,      device_id,      country_id,      region_id,      city_id,      carrier_id,      customer_name,      device_uuid,      action_type,      action_name,      view_name,      ch_start_date,      toUInt64(intDiv(timestamp, 60000) * 60000) AS timestamp,      sumState(duration) AS duration,      countIfState(http_error_count > 0) AS error_count,      sumState(is_slow) AS slow_count,      countState() AS total_count,      sumState(http_bytes_sent) AS bytes_sent,      sumState(http_bytes_received) AS bytes_received FROM midata.mi_action_local
 where ch_start_date='2020-1-4'
GROUP BY app_id, customer_name, device_uuid, app_version_id, os_id, device_id, country_id, region_id, city_id, carrier_id, action_type, action_name, view_name, ch_start_date, timestamp;
insert into midata.mi_action_agg_customer_1m_local (    app_id ,    app_version_id ,    os_id ,    device_id ,    country_id ,    region_id ,    city_id ,    carrier_id ,    customer_name ,    device_uuid ,    action_type ,    action_name ,    view_name ,    ch_start_date ,    timestamp ,    duration ,    error_count ,    slow_count ,    total_count ,    bytes_sent ,    bytes_received) SELECT      app_id,      app_version_id,      os_id,      device_id,      country_id,      region_id,      city_id,      carrier_id,      customer_name,      device_uuid,      action_type,      action_name,      view_name,      ch_start_date,      toUInt64(intDiv(timestamp, 60000) * 60000) AS timestamp,      sumState(duration) AS duration,      countIfState(http_error_count > 0) AS error_count,      sumState(is_slow) AS slow_count,      countState() AS total_count,      sumState(http_bytes_sent) AS bytes_sent,      sumState(http_bytes_received) AS bytes_received FROM midata.mi_action_local
 where ch_start_date='2020-1-3'
GROUP BY app_id, customer_name, device_uuid, app_version_id, os_id, device_id, country_id, region_id, city_id, carrier_id, action_type, action_name, view_name, ch_start_date, timestamp;
insert into midata.mi_action_agg_customer_1m_local (    app_id ,    app_version_id ,    os_id ,    device_id ,    country_id ,    region_id ,    city_id ,    carrier_id ,    customer_name ,    device_uuid ,    action_type ,    action_name ,    view_name ,    ch_start_date ,    timestamp ,    duration ,    error_count ,    slow_count ,    total_count ,    bytes_sent ,    bytes_received) SELECT      app_id,      app_version_id,      os_id,      device_id,      country_id,      region_id,      city_id,      carrier_id,      customer_name,      device_uuid,      action_type,      action_name,      view_name,      ch_start_date,      toUInt64(intDiv(timestamp, 60000) * 60000) AS timestamp,      sumState(duration) AS duration,      countIfState(http_error_count > 0) AS error_count,      sumState(is_slow) AS slow_count,      countState() AS total_count,      sumState(http_bytes_sent) AS bytes_sent,      sumState(http_bytes_received) AS bytes_received FROM midata.mi_action_local
 where ch_start_date='2020-1-2'
GROUP BY app_id, customer_name, device_uuid, app_version_id, os_id, device_id, country_id, region_id, city_id, carrier_id, action_type, action_name, view_name, ch_start_date, timestamp;
insert into midata.mi_action_agg_customer_1m_local (    app_id ,    app_version_id ,    os_id ,    device_id ,    country_id ,    region_id ,    city_id ,    carrier_id ,    customer_name ,    device_uuid ,    action_type ,    action_name ,    view_name ,    ch_start_date ,    timestamp ,    duration ,    error_count ,    slow_count ,    total_count ,    bytes_sent ,    bytes_received) SELECT      app_id,      app_version_id,      os_id,      device_id,      country_id,      region_id,      city_id,      carrier_id,      customer_name,      device_uuid,      action_type,      action_name,      view_name,      ch_start_date,      toUInt64(intDiv(timestamp, 60000) * 60000) AS timestamp,      sumState(duration) AS duration,      countIfState(http_error_count > 0) AS error_count,      sumState(is_slow) AS slow_count,      countState() AS total_count,      sumState(http_bytes_sent) AS bytes_sent,      sumState(http_bytes_received) AS bytes_received FROM midata.mi_action_local
 where ch_start_date='2020-1-1'
GROUP BY app_id, customer_name, device_uuid, app_version_id, os_id, device_id, country_id, region_id, city_id, carrier_id, action_type, action_name, view_name, ch_start_date, timestamp;
insert into midata.mi_action_agg_customer_1m_local (    app_id ,    app_version_id ,    os_id ,    device_id ,    country_id ,    region_id ,    city_id ,    carrier_id ,    customer_name ,    device_uuid ,    action_type ,    action_name ,    view_name ,    ch_start_date ,    timestamp ,    duration ,    error_count ,    slow_count ,    total_count ,    bytes_sent ,    bytes_received) SELECT      app_id,      app_version_id,      os_id,      device_id,      country_id,      region_id,      city_id,      carrier_id,      customer_name,      device_uuid,      action_type,      action_name,      view_name,      ch_start_date,      toUInt64(intDiv(timestamp, 60000) * 60000) AS timestamp,      sumState(duration) AS duration,      countIfState(http_error_count > 0) AS error_count,      sumState(is_slow) AS slow_count,      countState() AS total_count,      sumState(http_bytes_sent) AS bytes_sent,      sumState(http_bytes_received) AS bytes_received FROM midata.mi_action_local
 where ch_start_date='2019-12-31'
GROUP BY app_id, customer_name, device_uuid, app_version_id, os_id, device_id, country_id, region_id, city_id, carrier_id, action_type, action_name, view_name, ch_start_date, timestamp;
insert into midata.mi_action_agg_customer_1m_local (    app_id ,    app_version_id ,    os_id ,    device_id ,    country_id ,    region_id ,    city_id ,    carrier_id ,    customer_name ,    device_uuid ,    action_type ,    action_name ,    view_name ,    ch_start_date ,    timestamp ,    duration ,    error_count ,    slow_count ,    total_count ,    bytes_sent ,    bytes_received) SELECT      app_id,      app_version_id,      os_id,      device_id,      country_id,      region_id,      city_id,      carrier_id,      customer_name,      device_uuid,      action_type,      action_name,      view_name,      ch_start_date,      toUInt64(intDiv(timestamp, 60000) * 60000) AS timestamp,      sumState(duration) AS duration,      countIfState(http_error_count > 0) AS error_count,      sumState(is_slow) AS slow_count,      countState() AS total_count,      sumState(http_bytes_sent) AS bytes_sent,      sumState(http_bytes_received) AS bytes_received FROM midata.mi_action_local
 where ch_start_date='2019-12-30'
GROUP BY app_id, customer_name, device_uuid, app_version_id, os_id, device_id, country_id, region_id, city_id, carrier_id, action_type, action_name, view_name, ch_start_date, timestamp;
insert into midata.mi_action_agg_customer_1m_local (    app_id ,    app_version_id ,    os_id ,    device_id ,    country_id ,    region_id ,    city_id ,    carrier_id ,    customer_name ,    device_uuid ,    action_type ,    action_name ,    view_name ,    ch_start_date ,    timestamp ,    duration ,    error_count ,    slow_count ,    total_count ,    bytes_sent ,    bytes_received) SELECT      app_id,      app_version_id,      os_id,      device_id,      country_id,      region_id,      city_id,      carrier_id,      customer_name,      device_uuid,      action_type,      action_name,      view_name,      ch_start_date,      toUInt64(intDiv(timestamp, 60000) * 60000) AS timestamp,      sumState(duration) AS duration,      countIfState(http_error_count > 0) AS error_count,      sumState(is_slow) AS slow_count,      countState() AS total_count,      sumState(http_bytes_sent) AS bytes_sent,      sumState(http_bytes_received) AS bytes_received FROM midata.mi_action_local
 where ch_start_date='2019-12-29'
GROUP BY app_id, customer_name, device_uuid, app_version_id, os_id, device_id, country_id, region_id, city_id, carrier_id, action_type, action_name, view_name, ch_start_date, timestamp;
insert into midata.mi_action_agg_customer_1m_local (    app_id ,    app_version_id ,    os_id ,    device_id ,    country_id ,    region_id ,    city_id ,    carrier_id ,    customer_name ,    device_uuid ,    action_type ,    action_name ,    view_name ,    ch_start_date ,    timestamp ,    duration ,    error_count ,    slow_count ,    total_count ,    bytes_sent ,    bytes_received) SELECT      app_id,      app_version_id,      os_id,      device_id,      country_id,      region_id,      city_id,      carrier_id,      customer_name,      device_uuid,      action_type,      action_name,      view_name,      ch_start_date,      toUInt64(intDiv(timestamp, 60000) * 60000) AS timestamp,      sumState(duration) AS duration,      countIfState(http_error_count > 0) AS error_count,      sumState(is_slow) AS slow_count,      countState() AS total_count,      sumState(http_bytes_sent) AS bytes_sent,      sumState(http_bytes_received) AS bytes_received FROM midata.mi_action_local
 where ch_start_date='2019-12-28'
GROUP BY app_id, customer_name, device_uuid, app_version_id, os_id, device_id, country_id, region_id, city_id, carrier_id, action_type, action_name, view_name, ch_start_date, timestamp;
insert into midata.mi_action_agg_customer_1m_local (    app_id ,    app_version_id ,    os_id ,    device_id ,    country_id ,    region_id ,    city_id ,    carrier_id ,    customer_name ,    device_uuid ,    action_type ,    action_name ,    view_name ,    ch_start_date ,    timestamp ,    duration ,    error_count ,    slow_count ,    total_count ,    bytes_sent ,    bytes_received) SELECT      app_id,      app_version_id,      os_id,      device_id,      country_id,      region_id,      city_id,      carrier_id,      customer_name,      device_uuid,      action_type,      action_name,      view_name,      ch_start_date,      toUInt64(intDiv(timestamp, 60000) * 60000) AS timestamp,      sumState(duration) AS duration,      countIfState(http_error_count > 0) AS error_count,      sumState(is_slow) AS slow_count,      countState() AS total_count,      sumState(http_bytes_sent) AS bytes_sent,      sumState(http_bytes_received) AS bytes_received FROM midata.mi_action_local
 where ch_start_date='2019-12-27'
GROUP BY app_id, customer_name, device_uuid, app_version_id, os_id, device_id, country_id, region_id, city_id, carrier_id, action_type, action_name, view_name, ch_start_date, timestamp;
insert into midata.mi_action_agg_customer_1m_local (    app_id ,    app_version_id ,    os_id ,    device_id ,    country_id ,    region_id ,    city_id ,    carrier_id ,    customer_name ,    device_uuid ,    action_type ,    action_name ,    view_name ,    ch_start_date ,    timestamp ,    duration ,    error_count ,    slow_count ,    total_count ,    bytes_sent ,    bytes_received) SELECT      app_id,      app_version_id,      os_id,      device_id,      country_id,      region_id,      city_id,      carrier_id,      customer_name,      device_uuid,      action_type,      action_name,      view_name,      ch_start_date,      toUInt64(intDiv(timestamp, 60000) * 60000) AS timestamp,      sumState(duration) AS duration,      countIfState(http_error_count > 0) AS error_count,      sumState(is_slow) AS slow_count,      countState() AS total_count,      sumState(http_bytes_sent) AS bytes_sent,      sumState(http_bytes_received) AS bytes_received FROM midata.mi_action_local
 where ch_start_date='2019-12-26'
GROUP BY app_id, customer_name, device_uuid, app_version_id, os_id, device_id, country_id, region_id, city_id, carrier_id, action_type, action_name, view_name, ch_start_date, timestamp;
insert into midata.mi_action_agg_customer_1m_local (    app_id ,    app_version_id ,    os_id ,    device_id ,    country_id ,    region_id ,    city_id ,    carrier_id ,    customer_name ,    device_uuid ,    action_type ,    action_name ,    view_name ,    ch_start_date ,    timestamp ,    duration ,    error_count ,    slow_count ,    total_count ,    bytes_sent ,    bytes_received) SELECT      app_id,      app_version_id,      os_id,      device_id,      country_id,      region_id,      city_id,      carrier_id,      customer_name,      device_uuid,      action_type,      action_name,      view_name,      ch_start_date,      toUInt64(intDiv(timestamp, 60000) * 60000) AS timestamp,      sumState(duration) AS duration,      countIfState(http_error_count > 0) AS error_count,      sumState(is_slow) AS slow_count,      countState() AS total_count,      sumState(http_bytes_sent) AS bytes_sent,      sumState(http_bytes_received) AS bytes_received FROM midata.mi_action_local
 where ch_start_date='2019-12-25'
GROUP BY app_id, customer_name, device_uuid, app_version_id, os_id, device_id, country_id, region_id, city_id, carrier_id, action_type, action_name, view_name, ch_start_date, timestamp;
insert into midata.mi_action_agg_customer_1m_local (    app_id ,    app_version_id ,    os_id ,    device_id ,    country_id ,    region_id ,    city_id ,    carrier_id ,    customer_name ,    device_uuid ,    action_type ,    action_name ,    view_name ,    ch_start_date ,    timestamp ,    duration ,    error_count ,    slow_count ,    total_count ,    bytes_sent ,    bytes_received) SELECT      app_id,      app_version_id,      os_id,      device_id,      country_id,      region_id,      city_id,      carrier_id,      customer_name,      device_uuid,      action_type,      action_name,      view_name,      ch_start_date,      toUInt64(intDiv(timestamp, 60000) * 60000) AS timestamp,      sumState(duration) AS duration,      countIfState(http_error_count > 0) AS error_count,      sumState(is_slow) AS slow_count,      countState() AS total_count,      sumState(http_bytes_sent) AS bytes_sent,      sumState(http_bytes_received) AS bytes_received FROM midata.mi_action_local
 where ch_start_date='2019-12-24'
GROUP BY app_id, customer_name, device_uuid, app_version_id, os_id, device_id, country_id, region_id, city_id, carrier_id, action_type, action_name, view_name, ch_start_date, timestamp;
insert into midata.mi_action_agg_customer_1m_local (    app_id ,    app_version_id ,    os_id ,    device_id ,    country_id ,    region_id ,    city_id ,    carrier_id ,    customer_name ,    device_uuid ,    action_type ,    action_name ,    view_name ,    ch_start_date ,    timestamp ,    duration ,    error_count ,    slow_count ,    total_count ,    bytes_sent ,    bytes_received) SELECT      app_id,      app_version_id,      os_id,      device_id,      country_id,      region_id,      city_id,      carrier_id,      customer_name,      device_uuid,      action_type,      action_name,      view_name,      ch_start_date,      toUInt64(intDiv(timestamp, 60000) * 60000) AS timestamp,      sumState(duration) AS duration,      countIfState(http_error_count > 0) AS error_count,      sumState(is_slow) AS slow_count,      countState() AS total_count,      sumState(http_bytes_sent) AS bytes_sent,      sumState(http_bytes_received) AS bytes_received FROM midata.mi_action_local
 where ch_start_date='2019-12-23'
GROUP BY app_id, customer_name, device_uuid, app_version_id, os_id, device_id, country_id, region_id, city_id, carrier_id, action_type, action_name, view_name, ch_start_date, timestamp;
insert into midata.mi_action_agg_customer_1m_local (    app_id ,    app_version_id ,    os_id ,    device_id ,    country_id ,    region_id ,    city_id ,    carrier_id ,    customer_name ,    device_uuid ,    action_type ,    action_name ,    view_name ,    ch_start_date ,    timestamp ,    duration ,    error_count ,    slow_count ,    total_count ,    bytes_sent ,    bytes_received) SELECT      app_id,      app_version_id,      os_id,      device_id,      country_id,      region_id,      city_id,      carrier_id,      customer_name,      device_uuid,      action_type,      action_name,      view_name,      ch_start_date,      toUInt64(intDiv(timestamp, 60000) * 60000) AS timestamp,      sumState(duration) AS duration,      countIfState(http_error_count > 0) AS error_count,      sumState(is_slow) AS slow_count,      countState() AS total_count,      sumState(http_bytes_sent) AS bytes_sent,      sumState(http_bytes_received) AS bytes_received FROM midata.mi_action_local
 where ch_start_date='2019-12-22'
GROUP BY app_id, customer_name, device_uuid, app_version_id, os_id, device_id, country_id, region_id, city_id, carrier_id, action_type, action_name, view_name, ch_start_date, timestamp;
insert into midata.mi_action_agg_customer_1m_local (    app_id ,    app_version_id ,    os_id ,    device_id ,    country_id ,    region_id ,    city_id ,    carrier_id ,    customer_name ,    device_uuid ,    action_type ,    action_name ,    view_name ,    ch_start_date ,    timestamp ,    duration ,    error_count ,    slow_count ,    total_count ,    bytes_sent ,    bytes_received) SELECT      app_id,      app_version_id,      os_id,      device_id,      country_id,      region_id,      city_id,      carrier_id,      customer_name,      device_uuid,      action_type,      action_name,      view_name,      ch_start_date,      toUInt64(intDiv(timestamp, 60000) * 60000) AS timestamp,      sumState(duration) AS duration,      countIfState(http_error_count > 0) AS error_count,      sumState(is_slow) AS slow_count,      countState() AS total_count,      sumState(http_bytes_sent) AS bytes_sent,      sumState(http_bytes_received) AS bytes_received FROM midata.mi_action_local
 where ch_start_date='2019-12-21'
GROUP BY app_id, customer_name, device_uuid, app_version_id, os_id, device_id, country_id, region_id, city_id, carrier_id, action_type, action_name, view_name, ch_start_date, timestamp;
insert into midata.mi_action_agg_customer_1m_local (    app_id ,    app_version_id ,    os_id ,    device_id ,    country_id ,    region_id ,    city_id ,    carrier_id ,    customer_name ,    device_uuid ,    action_type ,    action_name ,    view_name ,    ch_start_date ,    timestamp ,    duration ,    error_count ,    slow_count ,    total_count ,    bytes_sent ,    bytes_received) SELECT      app_id,      app_version_id,      os_id,      device_id,      country_id,      region_id,      city_id,      carrier_id,      customer_name,      device_uuid,      action_type,      action_name,      view_name,      ch_start_date,      toUInt64(intDiv(timestamp, 60000) * 60000) AS timestamp,      sumState(duration) AS duration,      countIfState(http_error_count > 0) AS error_count,      sumState(is_slow) AS slow_count,      countState() AS total_count,      sumState(http_bytes_sent) AS bytes_sent,      sumState(http_bytes_received) AS bytes_received FROM midata.mi_action_local
 where ch_start_date='2019-12-20'
GROUP BY app_id, customer_name, device_uuid, app_version_id, os_id, device_id, country_id, region_id, city_id, carrier_id, action_type, action_name, view_name, ch_start_date, timestamp;

